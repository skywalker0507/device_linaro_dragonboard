{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "59d76dd3_7c51aa96",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1684060
      },
      "writtenOn": "2021-08-23T09:20:27Z",
      "side": 1,
      "message": "Looks like it\u0027s done by init:\nhttps://cs.android.com/android/platform/superproject/+/master:system/core/init/init.cpp;l\u003d551;drc\u003d0e5ad5a09385541b9e31a8c47993d1e282810ccb\n\n\n",
      "revId": "ba771793129ad4bfda93e53a7e13aea619b92108",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e05abc31_ca652f0d",
        "filename": "sepolicy/set-udc-sh.te",
        "patchSetId": 2
      },
      "lineNbr": 14,
      "author": {
        "id": 1010110
      },
      "writtenOn": "2021-07-22T22:21:07Z",
      "side": 1,
      "message": "Not sure what to do here in order to allow the set_udc.sh script to call setprop on sys.usb.controller",
      "revId": "ba771793129ad4bfda93e53a7e13aea619b92108",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cfbb1d7f_b0feb7ed",
        "filename": "sepolicy/set-udc-sh.te",
        "patchSetId": 2
      },
      "lineNbr": 14,
      "author": {
        "id": 1081223
      },
      "writtenOn": "2021-07-23T08:45:50Z",
      "side": 1,
      "message": "Since vendor_init is allowed you can use another property+trigger to do that\n\nproperty.te\ntype vendor_usb_prop, property_type;\n\nproperty_context\nvendor.usb.                u:object_r:vendor_usb_prop:s0\n\nset-udh-sg.te\nset_prop(set-udc-sh, vendor_usb_prop)\n\ninit.common.usb.rc\non property:vendor.usb.controller\u003d*\n    setprop sys.usb.controller ${vendor.usb.controller}\n    \nprop names/context are used in the latest QCOM BSP, so I just went with them.\n\nNOTE: newer bootloaders started to put the controller in cmdline so if available you can use\non property:ro.boot.usbcontroller\u003d*\n    setprop sys.usb.controller ${ro.boot.usbcontroller}",
      "parentUuid": "e05abc31_ca652f0d",
      "revId": "ba771793129ad4bfda93e53a7e13aea619b92108",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ab688142_5b9a15ee",
        "filename": "sepolicy/set-udc-sh.te",
        "patchSetId": 2
      },
      "lineNbr": 14,
      "author": {
        "id": 1031448
      },
      "writtenOn": "2021-07-23T09:30:15Z",
      "side": 1,
      "message": "Luca beat me to that :p\n\nI cooked up a similar implementation as he suggested https://android-review.googlesource.com/c/device/linaro/dragonboard/+/1774872. Smoke tested on RB5. I\u0027ll try it on RB3 now.\n\nI tried to be clever and falied miserably after spending sometime on something like \"exec - root system -- /system/bin/setprop vendor.sys.usb.controller `/system/bin/ls /sys/class/udc | /system/bin/grep -v dummy`\" but nope didn\u0027t get through that.",
      "parentUuid": "cfbb1d7f_b0feb7ed",
      "revId": "ba771793129ad4bfda93e53a7e13aea619b92108",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ab2cd43c_9e491b5b",
        "filename": "sepolicy/set-udc-sh.te",
        "patchSetId": 2
      },
      "lineNbr": 14,
      "author": {
        "id": 1010110
      },
      "writtenOn": "2021-07-23T18:10:19Z",
      "side": 1,
      "message": "Luca: Thanks so much for the suggestion! Very helpful! It seems Amit\u0027s using exactly that, so I\u0027ll abandon this and move over to his series.",
      "parentUuid": "ab688142_5b9a15ee",
      "revId": "ba771793129ad4bfda93e53a7e13aea619b92108",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}