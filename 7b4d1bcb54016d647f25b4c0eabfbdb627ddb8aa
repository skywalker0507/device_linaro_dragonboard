{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "0dafc93f_32abb913",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1010110
      },
      "writtenOn": "2021-09-02T03:56:16Z",
      "side": 1,
      "message": "Just initial WIP pass on this. Feedback on the approach would be welcome!",
      "revId": "7b4d1bcb54016d647f25b4c0eabfbdb627ddb8aa",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eed4f740_814f0d54",
        "filename": "audio/audio_hw.c",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1890913
      },
      "writtenOn": "2021-09-03T12:19:31Z",
      "side": 1,
      "message": "I\u0027m not sure how feasible it is to implement, but can\u0027t we make use of https://android.googlesource.com/platform/system/media/+/master/audio/include/system/audio-hal-enums.h#323 and intelligently do audio card switching by looking at out-\u003edevices and picking the output card based on that.",
      "revId": "7b4d1bcb54016d647f25b4c0eabfbdb627ddb8aa",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c889c33f_a9cf2d4d",
        "filename": "audio/audio_hw.c",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1010110
      },
      "writtenOn": "2021-09-10T05:20:42Z",
      "side": 1,
      "message": "Hey Caleb, thanks for the input on this! Thouh I\u0027m not sure I totally understand your proposal.\n\nWhile the out-\u003edevices value does help us understand what type of output system is asking for, it doesn\u0027t really help us map the output type to the actual snd card device/port. \n\nI\u0027m finding tinyalsa to be quite limiting in this way, as it seems to come from a perspective of \"you know what card/port you want to use - so lets enable that via static config\", where as in these more dynamic situations with multiple cards (which can initialize in different orders), we really need some better enumerate/query/probe methods, which tinyalsa doesn\u0027t seem to provide.\n\nI sort of wish there was a libsmallalsa that helped there :)\n\nSo this patch is sort of trying to still go with a static \"we know what we want\" config, but then have it try the next device if things fail. Still not ideal, but a touch more flexible than the static config.\n\nBut I do agree it would be nice to have something that allowed us to review the list of cards and query for attributes, which would let us match the requested out-\u003edevices value.\n\nSorry, this has gotten a bit long. Did your suggestion just sail over my head?",
      "parentUuid": "eed4f740_814f0d54",
      "revId": "7b4d1bcb54016d647f25b4c0eabfbdb627ddb8aa",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d1f71651_9b433b33",
        "filename": "audio/audio_hw.c",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1890913
      },
      "writtenOn": "2021-09-10T22:53:41Z",
      "side": 1,
      "message": "I guess what I\u0027m trying to suggest is that you can infer the sound card based on the output device, at least you can know which sound card it is not. If the output device is USB (I don\u0027t have the list to hand, I seem to remember seem some USB / external options) then we be sure that it\u0027s not sound card zero, as that should always be the built in audio. If  it\u0027s possible to fetch information about a given sound card then we can produce a set of rules to determine which output device we should be using at any given point in time based on what outputs are available.\n\nI\u0027m not sure how desirable that functionality is though, it might be more effort than it\u0027s worth for the rb3.",
      "parentUuid": "c889c33f_a9cf2d4d",
      "revId": "7b4d1bcb54016d647f25b4c0eabfbdb627ddb8aa",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}